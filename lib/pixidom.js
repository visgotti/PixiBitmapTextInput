!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.PIXI_DOM=e():t.PIXI_DOM=e()}(window,function(){return function(t){var e={};function s(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,s),r.l=!0,r.exports}return s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)s.d(i,r,function(e){return t[e]}.bind(null,r));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=0)}([function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=s(1);e.TextField=i.default},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=s(2),r=s(3),n=function(){return{width:"500px",height:"16px",fontColor:0,highlightedFontColor:16777215,borderColor:0,borderWidth:1,cursorColor:0,cursorHeight:"90%",cursorWidth:1,backgroundColor:16250871,highlightedBackgroundColor:128,borderOpacity:1,xPadding:0,yPadding:0}},o=["width","height","cursorHeight"];e.default=r.default(class extends PIXI.Container{constructor(t,e,s,i){super(),this.styleOptions={},this.cursorSprite=new PIXI.Graphics,this.textbox=new PIXI.Graphics,this.textboxMask=new PIXI.Graphics,this.inFocus=!1,this.cursorIndex=-1,this.lastCursorTs=Date.now(),this.accCursorTime=0,this.toggleCursorTime=500,this.cursorIsVisible=!0,this._text="",this._visible=!0,this.overflowOffsetX=0,this.overflowOffsetY=0,this.dragIndexStart=0,this.dragIndexEnd=0,this.inDrag=!1,this.submitKeyCodes=[13],this.ignoreKeys=[],this.maxCharacterLength=null,this.onFocusHandler=()=>{},this.onBlurHandler=()=>{},this.onChangeHandler=()=>{},this.onSubmitHandler=()=>{},i&&(this.ignoreKeys=i);const r=Object.assign({},n());if(e)for(let t in e)r[t]=e[t];this.maxCharacterLength=s||null,this.buttonMode=!0,this.interactive=!0,this.textSprite=new PIXI.extras.BitmapText("",{font:t,align:"left"}),this.cursor="text",this.on("pointerdown",this.handleMouseDown.bind(this)),this.on("pointerup",this.handleMouseUp.bind(this)),this.on("pointermove",this.handleMouseMove.bind(this)),this.on("pointerupoutside",this.handleMouseUp.bind(this)),this.addChild(this.textboxMask),this.addChild(this.textbox),this.addChild(this.textSprite),this.addChild(this.cursorSprite),this.textSprite.mask=this.textboxMask,this.updateStyle(r),this.checkForOutsideClick=this.checkForOutsideClick.bind(this),this.show()}updateStyle(t){for(const e in t)if(o.includes(e)){const s=i.parseLengthMeasurements(t[e]);if(s.error)throw new Error(`Error for passed in style: ${e}, ${s.error}`);this.styleOptions[e]=s}else this.styleOptions[e]=t[e];this.redraw()}redraw(){this.redrawText(),this.redrawTextbox(),this.redrawCursor()}redrawCursor(){if(!this.inFocus)return this.cursorIsVisible=!1,void(this.cursorSprite.visible=!1);const t=this.getCursorXFromIndex(this.cursorIndex)-this.overflowOffsetX;this.cursorSprite.clear(),this.cursorSprite.lineStyle(this.styleOptions.cursorWidth,this.styleOptions.cursorColor);const{value:e,type:s}=this.styleOptions.cursorHeight,i="pixel"===s?e:Math.round(this.textbox.height*(e/100)),r=Math.min(this.textbox.height,i),n=(Math.max(this.textbox.height,i)-r)/2,o=Math.floor(n),h=Math.ceil(n);this.cursorSprite.moveTo(t,o).lineTo(t,i-h),this.getSelectedRange()?(this.cursorIsVisible=!1,this.cursorSprite.visible=!1):(this.cursorIsVisible=!0,this.cursorSprite.visible=!0)}redrawText(){const t=this.getSelectedRange();this.textSprite.y=this.styleOptions.yPadding,this.textSprite.x=this.styleOptions.xPadding;const e=this.getCursorXFromIndex(this.dragIndexEnd),{value:s,type:i}=this.styleOptions.width,r=window.innerWidth,n="pixel"===i?s:r*(s/100);e>n+this.overflowOffsetX?(this.overflowOffsetX=e-n,this.textSprite.x-=this.overflowOffsetX):e>n?e<n+this.overflowOffsetX?(e<this.overflowOffsetX&&(this.overflowOffsetX-=this.overflowOffsetX-e),this.textSprite.x-=this.overflowOffsetX):this.textSprite.x-=this.overflowOffsetX:this.overflowOffsetX=0;for(let e=0;e<this.textSprite.children.length;e++){const s=this.textSprite.children[e];if(t){const{indexes:i}=t,{start:r,end:n}=i;if(e>=r&&e<n){s.tint=this.styleOptions.highlightedFontColor;continue}}"fontColor"in this.styleOptions?s.tint=this.styleOptions.fontColor:s.tint=16777215}}redrawTextbox(){this.textbox.clear(),this.textbox.beginFill(this.styleOptions.backgroundColor,1),this.styleOptions.borderWidth>0&&!Number.isNaN(this.styleOptions.borderWidth)&&this.textbox.lineStyle(this.styleOptions.borderWidth,this.styleOptions.borderColor,this.styleOptions.borderOpacity);let{value:t,type:e}=this.styleOptions.height;const s=window.innerWidth,i=window.innerHeight,r="pixel"===e?t:i*(t/100);({value:t,type:e}=this.styleOptions.width);const n="pixel"===e?t:s*(t/100),o=this.getSelectedRange();if(this.textbox.drawRect(0,0,n,r),this.textbox.endFill(),o){let t=o.x.start-this.overflowOffsetX;const e=o.x.end-this.overflowOffsetX;this.textbox.beginFill(this.styleOptions.highlightedBackgroundColor,1);let s=e-t;t+(s=t+s>=n?n-t:e-t)===n&&s>n&&(t=0,s=n),this.textbox.drawRect(t,0,s,r),this.textbox.endFill()}this.textboxMask.clear(),this.textboxMask.drawRect(0,0,n,r)}handleMouseUp(t){const{x:e}=t.data.getLocalPosition(this);this.inDrag&&(this.cursorIndex=this.getCursorIndexFromX(e),this.handleRangeFinish())}handleMouseDown(t){this.clickedTimestamp=t.data.originalEvent.timeStamp;const{x:e}=t.data.getLocalPosition(this);this.inFocus||this.focus(),this.clearRange(),this.cursorIndex=this.getCursorIndexFromX(e),this.handleRangeStart(this.cursorIndex),this.redraw()}handleMouseMove(t){if(this.inDrag){const{x:e}=t.data.getLocalPosition(this);this.handleRangeChange(this.getCursorIndexFromX(e))}}clearRange(){this.dragIndexEnd=this.cursorIndex,this.dragIndexStart=this.cursorIndex}handleRangeStart(t){this.inDrag=!0,this.dragIndexStart=t,this.dragIndexEnd=t}handleRangeChange(t){t!==this.dragIndexEnd&&(this.dragIndexEnd=t,this.redraw())}handleRangeFinish(){this.inDrag=!1}getCursorXFromIndex(t){let e;return!this.textSprite.children||!this.textSprite.children.length||t<=0?this.styleOptions.xPadding?this.styleOptions.xPadding:0:(e=t>=this.textSprite.children.length?this.textSprite.children[this.textSprite.children.length-1]:this.textSprite.children[t-1]).x+e.width+1}moveCursor(t){const e=this.cursorIndex+=t;e>-1&&e<=this.text.length&&(this.cursorIndex=e,this.clearRange(),this.redraw())}getCursorIndexFromX(t){if((t+=this.overflowOffsetX)<=0)return 0;for(let e=0;e<this.textSprite.children.length;e++){const s=this.textSprite.children[e];if(s.x+s.width>t)return s.x+s.width/2<t?e+1:e}return this.textSprite.children.length}getSelectedChars(){const t=this.getSelectedRange();if(!t)return"";const{indexes:e}=t,{start:s,end:i}=e;return this.text.substr(s,i-s)}replaceSelectedWith(t){const e=t.split(""),s=e.length;this.text;const i=this.text.split("");let r,n;const o=this.getSelectedRangeIndexes();o?({start:r,end:n}=o):r=n=this.cursorIndex;const h=n-r;return i.splice(r,h,...e),this.change(i.join("")),this.cursorIndex=r+s,this.clearRange(),this.redraw(),this.text}getSelectedRangeIndexes(){const t=this.getSelectedRange();return t?{start:t.indexes.start,end:t.indexes.end}:null}getSelectedRange(){const t=Math.min(this.dragIndexStart,this.dragIndexEnd),e=Math.max(this.dragIndexStart,this.dragIndexEnd);return t===e?null:{indexes:{start:t,end:e},x:{start:this.getCursorXFromIndex(t),end:this.getCursorXFromIndex(e)}}}selectAll(){this.setSelectedRange(0,this.text.length)}setSelectedRange(t,e){this.dragIndexStart=t,this.dragIndexEnd=e,this.cursorIndex=e,this.redraw()}charFromPosition(t){return{left:null,right:null}}removeLeftOfCursor(){if(this.cursorIndex>0){const t=this.text.split("");t.splice(this.cursorIndex-1,1),this.cursorIndex--,this.change(t.join("")),this.redraw()}}removeRightOfCursor(){const t=this.text.split("");t.length&&this.cursorIndex<t.length&&(t.splice(this.cursorIndex,1),this.change(t.join("")),this.redraw())}onChange(t){this.onChangeHandler=t}onFocus(t){this.onFocusHandler=t}onBlur(t){this.onBlurHandler=t}onSubmit(t){this.onSubmitHandler=t}clear(){this.text="",this.cursorIndex=0,this.clearRange(),this.redraw()}submit(){this.onSubmitHandler(this.text)}focus(){this.inFocus||(document.addEventListener("mousedown",this.checkForOutsideClick),this.inFocus=!0,this.startCursorAnimation(),this.emit("focus"),this.onFocusHandler())}blur(){this.inFocus&&(document.removeEventListener("mousedown",this.checkForOutsideClick),this.inFocus=!1,this.stopCursorAnimation(),this.clearRange(),this.redraw(),this.emit("blur"),this.onBlurHandler())}change(t){t!==this.textSprite.text&&(this.textSprite.text=t,this.textSprite.updateTransform(),this.emit("change",t),this.onChangeHandler(t))}startCursorAnimation(){this.cursorAnimationFrame&&this.stopCursorAnimation(),this.blinkCursor()}stopCursorAnimation(){this.cursorSprite.visible=!1,this.cursorAnimationFrame&&(clearTimeout(this.cursorAnimationFrame),this.cursorAnimationFrame=null,this.accCursorTime=0)}blinkCursor(){this.cursorIsVisible&&(this.cursorSprite.visible=!this.cursorSprite.visible),this.cursorAnimationFrame=setTimeout(this.blinkCursor.bind(this),this.toggleCursorTime)}checkForOutsideClick(t){t.timeStamp!==this.clickedTimestamp&&this.blur()}get text(){return this.textSprite.text}set text(t){this.change(t)}set visible(t){super.visible=t,this._visible=t,t?this.startCursorAnimation():this.stopCursorAnimation()}get visible(){return this._visible}show(){this.visible=!0}hide(){this.visible=!1}})},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Number.isNaN=Number.isNaN||function(t){return"number"==typeof t&&isNaN(t)},e.parseLengthMeasurements=function(t){let e;try{const s=t.toString().slice(-2);if("%"===s.charAt(1)){if(e=parseInt(t.slice(0,-1)),Number.isNaN(e))throw new Error("Did not find a number in front of % sign");return{valid:!0,value:e,type:"percent"}}if("px"===s){if(e=parseInt(t.slice(0,-2)),Number.isNaN(e))throw new Error("Did not find a number in front of px");if(e<0)throw new Error("Can not have negative pixel length value");return{valid:!0,value:e,type:"pixel"}}throw new Error("Length values must either be in % or px")}catch(t){return{valid:!1,error:t.message}}}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return class extends t{constructor(...t){super(...t),this.copiedText="",this.textStates=[],this.currentStateIndex=-1,this.registerHandlers=this.registerHandlers.bind(this),this.unregisterHandlers=this.unregisterHandlers.bind(this),this.onCopy=this.onCopy.bind(this),this.onPaste=this.onPaste.bind(this),this.onCut=this.onCut.bind(this),this.onKeyPress=this.onKeyPress.bind(this),this.onKeyDown=this.onKeyDown.bind(this),super.on("focus",this.registerHandlers),super.on("blur",this.unregisterHandlers),this.stateInterval=null}changeStateIndex(t){const e=this.currentStateIndex=t;this.textStates[e]&&(super.change(this.textStates[e]),this.currentStateIndex=t)}registerHandlers(){document.addEventListener("copy",this.onCopy),document.addEventListener("cut",this.onCut),document.addEventListener("paste",this.onPaste),document.addEventListener("keypress",this.onKeyPress),document.addEventListener("keydown",this.onKeyDown)}unregisterHandlers(){document.removeEventListener("copy",this.onCopy),document.removeEventListener("cut",this.onCut),document.removeEventListener("paste",this.onPaste),document.removeEventListener("keypress",this.onKeyPress),document.removeEventListener("keydown",this.onKeyDown)}onPaste(t){const e=t.clipboardData?t.clipboardData.getData("text/plain"):this.copiedText,s=super.replaceSelectedWith(e);null!==s&&this.addState(s)}onCopy(t){t.preventDefault();const e=super.getSelectedChars();t.clipboardData&&t.clipboardData.setData("text/plain",e),this.copiedText=e}onCut(t){t.preventDefault();const e=super.getSelectedChars();t.clipboardData&&t.clipboardData.setData("text/plain",e),this.copiedText=e;const s=super.replaceSelectedWith("");null!==s&&this.addState(s)}onBackspace(){}onDelete(){}onKeyDown(t){const e=t.keyCode?t.keyCode:t.code;if(this.submitKeyCodes.includes(e))super.submit();else if(37==e)super.moveCursor(-1);else if(39==e)super.moveCursor(1);else if(8==e)super.getSelectedRange()?super.replaceSelectedWith(""):super.removeLeftOfCursor();else if(46==e)super.getSelectedRange()?super.replaceSelectedWith(""):super.removeRightOfCursor();else if(t.ctrlKey)if(90==e){const e=t.shiftKey?1:-1;this.changeStateIndex(e)}else 65==e&&(t.preventDefault(),super.selectAll())}onKeyPress(t){const e=t.keyCode?t.keyCode:t.which;if(this.submitKeyCodes.includes(e)||this.ignoreKeys.includes(e))return;const s=String.fromCharCode(e);s&&(t.ctrlKey||(t.preventDefault(),super.replaceSelectedWith(s)))}addState(t){this.textStates.push(t),this.currentStateIndex=this.textStates.length-1}}}}])});